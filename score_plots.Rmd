---
title: "Score_plots"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(dplyr)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
datalist = list()
i = 0
new_dat <- setNames(data.frame(matrix(ncol = 20, nrow = 0)), colnames(dat))
for(id in unique(dat$human_id)) {
  i <- i+1
  tdat <- subset(dat,human_id == id)
  tdat$part_num <- i
  tdat <- within(tdat, acc_sum <- cumsum(tdat$score))
  datalist[[i]] <- tdat
}

# Merge all datasets into one 
new_dat <- dplyr::bind_rows(datalist)
# or new_dat <- data.table::rbindlist(datalist)

# Add column for time t
new_dat <- new_dat %>% group_by(human_id) %>% mutate(t = row_number())

# Participant number as a factor 
# tdat$part_num <- as.factor(tdat$part_num)

# Add best fitting model per participant
new_dat <- merge(new_dat, Corr_Tr_model[, c("human_id", "Best_model")], by="human_id")
```


```{r}
ggplot(data = new_dat, aes(x = t, y=acc_sum, group = part_num)) + 
  geom_line(aes(color= Best_model))
```


```{r}
temp <- new_dat[,c("t","acc_sum","Best_model","condition","part_num")]
dat_by_model <- temp %>% group_by(Best_model,t) %>% 
  summarize(model_acc_sum = mean(acc_sum))

ggplot(data = dat_by_model, aes(x = t, y=model_acc_sum, group = Best_model)) + 
   geom_line(aes(color= Best_model))
```
